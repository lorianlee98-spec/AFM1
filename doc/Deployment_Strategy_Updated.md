# AI视频制片链路系统 - 部署策略文档 (更新版)

## 面向非技术人员的产品经理指南

**文档版本**: 2.0  
**创建日期**: 2026-02-09  
**适用对象**: 产品经理、非技术创始人、业务决策者  
**核心策略**: 免费起步，平滑升级

---

## 一、部署策略总览

### 1.1 核心理念

**"零成本启动，按需升级"**

- **阶段一 (MVP)**: 全免费托管方案，验证产品价值
- **阶段二 (增长)**: 混合方案，优化性能和成本
- **阶段三 (商业化)**: 专业部署，支撑大规模用户

### 1.2 技术架构适配

本项目采用前后端分离架构：
- **前端**: React 18 + TypeScript (静态网站)
- **后端**: Python FastAPI (API服务)
- **数据库**: PostgreSQL (关系型数据)
- **存储**: 对象存储 (图片、视频文件)
- **缓存**: Redis (可选)

这种架构天然适合现代云原生托管平台。

---

## 二、全免费托管方案 (阶段一：MVP验证)

### 2.1 方案概览

| 组件 | 托管平台 | 免费额度 | 月成本 |
|-----|---------|---------|--------|
| **前端** | Vercel | 无限静态托管 + 125k API请求 | ¥0 |
| **后端** | Render | 750小时/月 (24x7运行) | ¥0 |
| **数据库** | Supabase | 500MB + 2GB存储 | ¥0 |
| **文件存储** | Cloudflare R2 | 10GB + 100万次请求 | ¥0 |
| **总计** | - | - | **¥0** |

### 2.2 各组件详细说明

#### 2.2.1 前端托管 - Vercel

**通俗解释**:  
Vercel是专门托管网站前端的平台，就像把你的网站文件放在全球各地的快递站点，用户访问时从最近的站点获取，速度超快。

**免费额度**:
- 静态网站托管: 无限
- Serverless Functions: 125,000次/月
- 带宽: 100GB/月
- 构建时间: 6000分钟/月
- 并发构建: 2个

**优势**:
- Git推送后自动部署
- 全球CDN加速
- 自动HTTPS证书
- 预览环境自动生成

**限制**:
- 函数执行时间: 10秒
- 单个函数大小: 50MB

#### 2.2.2 后端托管 - Render

**通俗解释**:  
Render是托管后端程序的平台，你的Python程序就像放在Render的工厂里，有用户请求时工厂就开始工作，处理完就休息。

**免费额度**:
- 运行时间: 750小时/月 (足够31天连续运行)
- 带宽: 100GB/月
- 内存: 512MB
- 磁盘: 1GB

**重要特性**:
- **自动休眠**: 15分钟无访问后进入休眠 (节省资源)
- **冷启动**: 从休眠唤醒约需30秒
- **自动部署**: Git推送后自动更新

**优势**:
- 支持Python、Node.js等多种语言
- 内置PostgreSQL数据库 (可选)
- 简单的配置界面

**限制**:
- 免费版使用共享CPU
- 休眠机制影响首次访问体验

#### 2.2.3 数据库托管 - Supabase

**通俗解释**:  
Supabase是PostgreSQL数据库的托管服务，还附赠了用户认证、实时数据同步等功能，就像租了一个带保安和管家的数据仓库。

**免费额度**:
- PostgreSQL数据库: 500MB
- 存储空间: 2GB
- 带宽: 2GB/月
- 实时连接: 200个
- API请求: 无限

**优势**:
- 完整的PostgreSQL功能
- 内置用户认证系统
- 实时数据订阅
- 自动备份
- 友好的管理界面

**限制**:
- 数据库暂停: 7天无活动后自动暂停 (需手动唤醒)
- 性能限制: 共享资源

#### 2.2.4 文件存储 - Cloudflare R2

**通俗解释**:  
R2是存储图片、视频等大文件的地方，最大的卖点是**没有流量费**，其他平台下载文件要收钱，R2不收。

**免费额度**:
- 存储: 10GB/月
- A类操作 (上传): 100万次/月
- B类操作 (下载): 1000万次/月
- **出站流量**: 完全免费 (这是最大优势!)

**优势**:
- 零出站流量费 (视频传输超划算)
- 与Cloudflare CDN集成
- S3兼容API
- 全球分布

**适用场景**:
- 存储用户上传的图片
- 存储生成的视频文件
- 存储分镜图、人设图

### 2.3 免费方案架构图

```
用户访问
    │
    ▼
┌─────────────────────────────────────────────────────────┐
│                      前端层 (Vercel)                     │
│  ┌─────────────────────────────────────────────────┐   │
│  │  React 18 + TypeScript                          │   │
│  │  - 用户界面                                      │   │
│  │  - 与后端API通信                                 │   │
│  └─────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
    │
    │ API请求
    ▼
┌─────────────────────────────────────────────────────────┐
│                      后端层 (Render)                     │
│  ┌─────────────────────────────────────────────────┐   │
│  │  Python FastAPI                                 │   │
│  │  - 业务逻辑处理                                  │   │
│  │  - AI服务调用                                    │   │
│  │  - 数据读写                                      │   │
│  └─────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
    │
    ├──────────────────┬──────────────────┐
    ▼                  ▼                  ▼
┌──────────┐    ┌──────────┐    ┌──────────┐
│ Supabase │    │  R2存储  │    │ AI服务   │
│ (数据库)  │    │ (文件)   │    │ (外部)   │
└──────────┘    └──────────┘    └──────────┘
```

### 2.4 免费方案实施步骤

#### 第一步：账号注册 (1天)
1. **GitHub账号** (如果还没有)
2. **Vercel账号** (用GitHub登录)
3. **Render账号** (用GitHub登录)
4. **Supabase账号** (用GitHub登录)
5. **Cloudflare账号** (用邮箱注册)

#### 第二步：项目配置 (2天)
1. 创建GitHub代码仓库
2. 配置Vercel项目连接
3. 配置Render Web Service
4. 创建Supabase项目
5. 配置R2存储桶

#### 第三步：代码部署 (2天)
1. 推送前端代码到GitHub → 自动部署到Vercel
2. 推送后端代码到GitHub → 自动部署到Render
3. 配置数据库连接
4. 配置文件存储
5. 测试端到端流程

#### 第四步：优化配置 (1天)
1. 配置自定义域名 (可选)
2. 设置环境变量
3. 配置监控告警
4. 编写部署文档

**总计**: 约1周完成全免费部署

---

## 三、混合方案 (阶段二：用户增长)

### 3.1 何时升级？

**触发条件** (满足任一):
- 用户量超过 500人/月
- 免费额度使用超过 80%
- 需要更高性能 (冷启动影响体验)
- 需要更多存储空间

### 3.2 升级策略

#### 方案A: 部分付费升级 (推荐)

| 组件 | 当前方案 | 升级方案 | 月成本 |
|-----|---------|---------|--------|
| 前端 | Vercel免费版 | Vercel Pro ($20/月) | ¥140 |
| 后端 | Render免费版 | Render Starter ($7/月) | ¥50 |
| 数据库 | Supabase免费版 | Supabase Pro ($25/月) | ¥175 |
| 存储 | R2免费版 | R2免费版 (继续) | ¥0 |
| **总计** | - | - | **约¥365** |

**升级收益**:
- 消除冷启动问题
- 更高性能 (专用CPU)
- 更大存储空间
- 优先技术支持

#### 方案B: 自托管混合

| 组件 | 方案 | 月成本 |
|-----|------|--------|
| 前端 | Vercel Pro | ¥140 |
| 后端 | 阿里云轻量服务器 | ¥100 |
| 数据库 | 阿里云RDS | ¥150 |
| 存储 | 阿里云OSS | ¥50 |
| **总计** | - | **约¥440** |

**适用场景**:
- 对数据主权有要求
- 需要国内访问速度优化
- 长期成本更低

---

## 四、商业化部署方案 (阶段三：规模运营)

### 4.1 专业部署架构

```
┌─────────────────────────────────────────────────────────────┐
│                         负载均衡层                           │
│                    (阿里云SLB / AWS ALB)                     │
└─────────────────────────────────────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              ▼               ▼               ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│   应用服务器1    │ │   应用服务器2    │ │   应用服务器N    │
│  (Docker容器)   │ │  (Docker容器)   │ │  (Docker容器)   │
└─────────────────┘ └─────────────────┘ └─────────────────┘
              │               │               │
              └───────────────┼───────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      数据层                                  │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐    │
│  │PostgreSQL│  │  Redis   │  │  MinIO   │  │Elasticsearch│  │
│  │ (主从)   │  │ (集群)   │  │ (对象存储)│  │  (搜索)   │   │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘    │
└─────────────────────────────────────────────────────────────┘
```

### 4.2 成本预估 (月)

| 资源类型 | 配置 | 月成本 |
|---------|------|--------|
| 应用服务器 | 4核8GB × 2台 | ¥800 |
| 数据库 | RDS 4核8GB | ¥600 |
| 缓存 | Redis 2GB | ¥200 |
| 存储 | OSS 500GB | ¥150 |
| CDN | 1TB流量 | ¥100 |
| 负载均衡 | SLB | ¥50 |
| **总计** | - | **约¥1900** |

---

## 五、升级路径分析

### 5.1 从免费到付费的便利度

| 升级路径 | 便利度 | 工作量 | 风险 |
|---------|--------|--------|------|
| **免费 → 混合方案A** | ⭐⭐⭐⭐⭐ | 1天 | 低 |
| **免费 → 混合方案B** | ⭐⭐⭐ | 3-5天 | 中 |
| **混合 → 商业化** | ⭐⭐⭐⭐ | 1周 | 中 |
| **免费 → 商业化** | ⭐⭐ | 2周 | 高 |

### 5.2 数据迁移策略

#### 数据库迁移
```
Supabase (免费) → 阿里云RDS
- 使用pg_dump导出数据
- 使用psql导入数据
- 预计停机时间: 30分钟
- 风险: 低 (可回滚)
```

#### 文件迁移
```
Cloudflare R2 → 阿里云OSS
- 使用rclone工具同步
- 可在线迁移，零停机
- 风险: 极低
```

#### 代码迁移
```
Vercel/Render → 自托管
- 代码无需修改
- 仅需调整环境变量
- 风险: 极低
```

### 5.3 平滑升级建议

#### 阶段一 → 阶段二 (免费 → 混合)
1. **保留免费环境**作为备份
2. **并行运行**新旧环境
3. **逐步切流** (10% → 50% → 100%)
4. **监控验证**后再完全切换

#### 阶段二 → 阶段三 (混合 → 商业化)
1. **搭建新环境** (不与旧环境冲突)
2. **数据同步** (实时或定时)
3. **DNS切换** (快速回滚)
4. **监控观察** (24小时)

---

## 六、技术术语解释

| 术语 | 通俗解释 |
|-----|---------|
| **CDN** | 内容分发网络，让全球用户都能快速访问你的网站 |
| **冷启动** | 程序长时间不用后，首次启动需要等待 |
| **Serverless** | 无需管理服务器，代码在需要时自动运行 |
| **PostgreSQL** | 一种可靠的数据库软件 |
| **Redis** | 高速缓存，让数据读取更快 |
| **对象存储** | 存储图片、视频等大文件的地方 |
| **负载均衡** | 把用户请求分配到多台服务器 |
| **SSL证书** | 让网站使用HTTPS，数据传输加密 |
| **休眠** | 程序暂时停止运行，节省资源 |
| **带宽** | 数据传输的流量限制 |

---

## 七、决策建议

### 立即执行 ✅
1. **采用全免费方案启动**
   - 零成本验证产品价值
   - 快速上线获取用户反馈
   - 专注产品而非运维

2. **预留升级预算**
   - 阶段二: 准备¥500/月预算
   - 阶段三: 准备¥2000/月预算

### 本周完成 📅
1. 注册所有平台账号
2. 搭建开发环境
3. 完成首次部署

### 监控指标 📊
1. **免费额度使用率** (超过70%时预警)
2. **用户增长速度** (超过500人/月时考虑升级)
3. **服务响应时间** (超过2秒时优化)

---

## 八、总结

### 核心结论

1. **完全可以零成本启动**  
   使用Vercel + Render + Supabase + R2组合，月成本为¥0

2. **升级路径清晰平滑**  
   从免费到付费，从付费到自托管，都有明确的迁移方案

3. **风险可控**  
   每个阶段都保留回滚能力，数据迁移方案成熟

4. **按需投入**  
   根据用户增长逐步投入，避免早期过度投资

### 推荐时间线

| 阶段 | 时间 | 部署方案 | 月成本 | 用户量 |
|-----|------|---------|--------|--------|
| **MVP验证** | 1-3月 | 全免费 | ¥0 | 0-500 |
| **产品优化** | 4-6月 | 混合方案A | ¥365 | 500-2000 |
| **规模增长** | 7-12月 | 混合方案B | ¥440 | 2000-5000 |
| **商业化** | 12月+ | 专业部署 | ¥2000+ | 5000+ |

---

**文档维护**: 本文档将根据实际部署经验持续更新  
**最后更新**: 2026-02-09  
**版本**: 2.0
